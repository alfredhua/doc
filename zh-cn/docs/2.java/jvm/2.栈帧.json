{
  "filename": "2.栈帧.md",
  "__html": "<p>栈帧:每个栈帧对应一个被调用的方法，可以理解为一个方法的运行空间。</p>\n<p><img src=\"http://java-run-blog.oss-cn-zhangjiakou.aliyuncs.com/dcd8f3c3679b4b619b984a776e8a0d79.png\" alt=\"image\">\n每个栈帧中包括</p>\n<ul>\n<li>局部变量表(Local Variables)</li>\n<li>操作数栈(Operand Stack)、</li>\n<li>指向运行时常量池的引用(A reference to the run-time constant pool)、</li>\n<li>方法返回地址(Return Address)和附加信息。</li>\n</ul>\n<pre><code class=\"language-java\"><span class=\"hljs-class\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title\">Person</span></span>{\n    <span class=\"hljs-keyword\">private</span> String name=<span class=\"hljs-string\">\"hua\"</span>;\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">int</span> age;\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-keyword\">double</span> salary=<span class=\"hljs-number\">100</span>;\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> String address;\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-keyword\">static</span> String hobby=<span class=\"hljs-string\">\"Programming\"</span>;\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">say</span><span class=\"hljs-params\">()</span></span>{\n\nSystem.out.println(<span class=\"hljs-string\">\"person say...\"</span>); }\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">int</span> <span class=\"hljs-title\">calc</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">int</span> op1,<span class=\"hljs-keyword\">int</span> op2)</span></span>{\n        op1=<span class=\"hljs-number\">3</span>;\n        <span class=\"hljs-keyword\">int</span> result=op1+op2;\n        <span class=\"hljs-keyword\">return</span> result;\n    }\n\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">order</span><span class=\"hljs-params\">()</span></span>{\n    }\n    <span class=\"hljs-function\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title\">main</span><span class=\"hljs-params\">(String[] args)</span></span>{\n        calc(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>);\n        order();\n     }\n}\n</code></pre>\n<pre><code>//将int类型常量3压入[操作数栈]\n//将int类型值存入[局部变量0]\n//从[局部变量0]中装载int类型值入栈 \n//从[局部变量1]中装载int类型值入栈 \n//将栈顶元素弹出栈，执行int类型的加法，结果入栈\n0:  iconst_3\n1:  istore_0\n2:  iload_0\n3:  iload_1\n4:  iadd\n【For example, the iadd instruction (§iadd) adds two int values together. It\nrequires that the int values to be added be the top two values of the operand stack, pushed there by previous instructions. Both of the int values are popped from the operand stack. They are added, and their sum is pushed back onto the operand stack. Subcomputations may be nested on the operand stack, resulting in values that can be used by the encompassing computation.】\n5: istore_2\n6: iload_2\n7: ireturn\n//将栈顶int类型值保存到[局部变量2]中 \n//从[局部变量2]中装载int类型值入栈 \n//从方法中返回int类型的数据\n</code></pre>\n<p><img src=\"http://java-run-blog.oss-cn-zhangjiakou.aliyuncs.com/fe42195a4d7d403183e13105b6146292.png\" alt=\"image\"></p>\n<p>如果在栈帧中有一个变量，类型为引用类型，比如Object obj=new Object()，这时候就是典型的栈中元素指向堆中的 对象。</p>\n<p>方法区指向堆：\n方法区中会存放静态变量，常量等数据。如果是下面这种情况，就是典型的方法区中元素指向堆中的对象。</p>\n<pre><code class=\"language-java\"><span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> Object obj=<span class=\"hljs-keyword\">new</span> Object();\n</code></pre>\n<p>思考 :一个对象怎么知道它是由哪个类创建出来的?怎么记录?这就需要了解一个Java对象的具体信息咯。</p>\n<p><img src=\"http://java-run-blog.oss-cn-zhangjiakou.aliyuncs.com/1126821effc84e35befcedc788130a55.png\" alt=\"image\">\nJava对象内存布局\n一个Java对象在内存中包括3个部分:对象头、实例数据和对齐填充</p>\n<p><img src=\"http://java-run-blog.oss-cn-zhangjiakou.aliyuncs.com/e1426ee48f6b4f79b5838ac343ab9af2.png\" alt=\"image\"></p>\n",
  "link": "/zh-cn/docs/2.java/jvm/2.栈帧.html",
  "meta": {}
}