{
  "filename": "3.logstash导入数据.md",
  "__html": "<h2 id=\"logstash\">logstash <a class=\"header-anchor\" href=\"#logstash\">#</a></h2>\n<ol>\n<li>下载对应版本的logstash</li>\n</ol>\n<blockquote>\n<p>wget <a href=\"https://artifacts.elastic.co/downloads/logstash/logstash-7.1.1.tar.gz\">https://artifacts.elastic.co/downloads/logstash/logstash-7.1.1.tar.gz</a></p>\n</blockquote>\n<ol start=\"2\">\n<li>\n<p>下载测试数据</p>\n<blockquote>\n<p>下载最MovieLens最小测试数据集：<a href=\"https://grouplens.org/datasets/movielens/\">https://grouplens.org/datasets/movielens/</a></p>\n</blockquote>\n</li>\n<li>\n<p>配置文件logstash.conf</p>\n</li>\n</ol>\n<pre><code class=\"language-java\">input {\n  file {\n    path =&gt; <span class=\"hljs-string\">\"/root/movies.csv\"</span>  <span class=\"hljs-comment\">//修改为自己的文件配置目录</span>\n    start_position =&gt; <span class=\"hljs-string\">\"beginning\"</span>\n    sincedb_path =&gt; <span class=\"hljs-string\">\"/dev/null\"</span>\n  }\n}\nfilter {\n  csv {\n    separator =&gt; <span class=\"hljs-string\">\",\"</span>\n    columns =&gt; [<span class=\"hljs-string\">\"id\"</span>,<span class=\"hljs-string\">\"content\"</span>,<span class=\"hljs-string\">\"genre\"</span>]\n  }\n\n  mutate {\n    split =&gt; { <span class=\"hljs-string\">\"genre\"</span> =&gt; <span class=\"hljs-string\">\"|\"</span> }\n    remove_field =&gt; [<span class=\"hljs-string\">\"path\"</span>, <span class=\"hljs-string\">\"host\"</span>,<span class=\"hljs-string\">\"@timestamp\"</span>,<span class=\"hljs-string\">\"message\"</span>]\n  }\n\n  mutate {\n\n    split =&gt; [<span class=\"hljs-string\">\"content\"</span>, <span class=\"hljs-string\">\"(\"</span>]\n    add_field =&gt; { <span class=\"hljs-string\">\"title\"</span> =&gt; <span class=\"hljs-string\">\"%{[content][0]}\"</span>}\n    add_field =&gt; { <span class=\"hljs-string\">\"year\"</span> =&gt; <span class=\"hljs-string\">\"%{[content][1]}\"</span>}\n  }\n\n  mutate {\n    convert =&gt; {\n      <span class=\"hljs-string\">\"year\"</span> =&gt; <span class=\"hljs-string\">\"integer\"</span>\n    }\n    strip =&gt; [<span class=\"hljs-string\">\"title\"</span>]\n    remove_field =&gt; [<span class=\"hljs-string\">\"path\"</span>, <span class=\"hljs-string\">\"host\"</span>,<span class=\"hljs-string\">\"@timestamp\"</span>,<span class=\"hljs-string\">\"message\"</span>,<span class=\"hljs-string\">\"content\"</span>]\n  }\n\n}\noutput {\n   elasticsearch {\n     hosts =&gt; <span class=\"hljs-string\">\"http://es:9200\"</span>   <span class=\"hljs-comment\">//修改为自己的es地址</span>\n     index =&gt; <span class=\"hljs-string\">\"movies\"</span>\n     document_id =&gt; <span class=\"hljs-string\">\"%{id}\"</span>\n   }\n  stdout {}\n}\n\n</code></pre>\n<ol start=\"4\">\n<li>执行命令sudo bin/logstash -f /YOUR_PATH_of_logstash.conf</li>\n</ol>\n",
  "link": "/zh-cn/docs/3.数据库/elasticsearch/3.logstash导入数据.html",
  "meta": {}
}