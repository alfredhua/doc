{
  "filename": "6.集群搭建.md",
  "__html": "<p>将俩个文件放在同一目录下，执行\ndocker-compose up -d 即可</p>\n<p>.env</p>\n<pre><code>ZK_MASTER_DIR=./master\n\nZK_SLAVE1_DIR=./slave1\n\nZK_SLAVE2_DIR=./slave2\n</code></pre>\n<p>docker-compose.yml:</p>\n<pre><code class=\"language-yml\"><span class=\"hljs-attr\">version:</span> <span class=\"hljs-string\">\"3.3\"</span>\n<span class=\"hljs-attr\">services:</span>\n  <span class=\"hljs-attr\">zk1:</span>\n    <span class=\"hljs-attr\">image:</span> <span class=\"hljs-string\">zookeeper:3.4</span>\n    <span class=\"hljs-attr\">restart:</span> <span class=\"hljs-string\">always</span>\n    <span class=\"hljs-attr\">container_name:</span> <span class=\"hljs-string\">zk1</span>\n    <span class=\"hljs-attr\">ports:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">\"2181:2181\"</span>\n    <span class=\"hljs-attr\">volumes:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_MASTER_DIR}/data:/data</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_MASTER_DIR}/datalog:/datalog</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_MASTER_DIR}/conf:/conf</span>\n    <span class=\"hljs-attr\">environment:</span>\n      <span class=\"hljs-attr\">ZOO_MY_ID:</span> <span class=\"hljs-number\">1</span>\n      <span class=\"hljs-attr\">ZOO_SERVERS:</span> <span class=\"hljs-string\">server.1=zk1:2888:3888</span> <span class=\"hljs-string\">server.2=zk2:2888:3888</span> <span class=\"hljs-string\">server.3=zk3:2888:3888</span>\n    <span class=\"hljs-comment\"># networks:</span>\n    <span class=\"hljs-comment\">#   zk-master:</span>\n    <span class=\"hljs-comment\">#     ipv4_address: 172.50.0.10</span>\n  <span class=\"hljs-attr\">zk2:</span>\n    <span class=\"hljs-attr\">image:</span> <span class=\"hljs-string\">zookeeper:3.4</span>\n    <span class=\"hljs-attr\">restart:</span> <span class=\"hljs-string\">always</span>\n    <span class=\"hljs-attr\">container_name:</span> <span class=\"hljs-string\">zk2</span>\n    <span class=\"hljs-attr\">ports:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">\"2182:2181\"</span>\n    <span class=\"hljs-attr\">environment:</span>\n      <span class=\"hljs-attr\">ZOO_MY_ID:</span> <span class=\"hljs-number\">2</span>\n      <span class=\"hljs-attr\">ZOO_SERVERS:</span> <span class=\"hljs-string\">server.1=zk1:2888:3888</span> <span class=\"hljs-string\">server.2=zk2:2888:3888</span> <span class=\"hljs-string\">server.3=zk3:2888:3888</span>\n    <span class=\"hljs-attr\">volumes:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_SLAVE1_DIR}/data:/data</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_SLAVE1_DIR}/datalog:/datalog</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_SLAVE1_DIR}/conf:/conf</span>\n    <span class=\"hljs-comment\"># networks:</span>\n    <span class=\"hljs-comment\">#   zk-slave:</span>\n    <span class=\"hljs-comment\">#     ipv4_address: 172.30.0.2</span>\n \n  <span class=\"hljs-attr\">zk3:</span>\n    <span class=\"hljs-attr\">image:</span> <span class=\"hljs-string\">zookeeper:3.4</span>\n    <span class=\"hljs-attr\">restart:</span> <span class=\"hljs-string\">always</span>\n    <span class=\"hljs-attr\">container_name:</span> <span class=\"hljs-string\">zk3</span>\n    <span class=\"hljs-attr\">ports:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">\"2183:2181\"</span>\n    <span class=\"hljs-attr\">environment:</span>\n      <span class=\"hljs-attr\">ZOO_MY_ID:</span> <span class=\"hljs-number\">3</span>\n      <span class=\"hljs-attr\">ZOO_SERVERS:</span> <span class=\"hljs-string\">server.1=zk1:2888:3888</span> <span class=\"hljs-string\">server.2=zk2:2888:3888</span> <span class=\"hljs-string\">server.3=zk3:2888:3888</span>\n    <span class=\"hljs-attr\">volumes:</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_SLAVE2_DIR}/data:/data</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_SLAVE2_DIR}/datalog:/datalog</span>\n      <span class=\"hljs-bullet\">-</span> <span class=\"hljs-string\">${ZK_SLAVE2_DIR}/conf:/conf</span>\n    <span class=\"hljs-comment\"># networks:</span>\n    <span class=\"hljs-comment\">#   zk-slave:</span>\n    <span class=\"hljs-comment\">#     ipv4_address: 172.30.0.3</span>\n\n<span class=\"hljs-attr\">networks:</span>\n  <span class=\"hljs-attr\">zk-master:</span>\n     <span class=\"hljs-attr\">driver:</span> <span class=\"hljs-string\">bridge</span> <span class=\"hljs-comment\"># 创建一个docker 的桥接网络</span>\n     <span class=\"hljs-attr\">ipam:</span>\n       <span class=\"hljs-attr\">driver:</span> <span class=\"hljs-string\">default</span>\n       <span class=\"hljs-attr\">config:</span>\n          <span class=\"hljs-bullet\">-</span>\n           <span class=\"hljs-attr\">subnet:</span> <span class=\"hljs-number\">172.50</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-string\">/16</span>\n  <span class=\"hljs-attr\">zk-slave:</span>\n       <span class=\"hljs-attr\">driver:</span> <span class=\"hljs-string\">bridge</span>\n       <span class=\"hljs-attr\">ipam:</span>\n         <span class=\"hljs-attr\">driver:</span> <span class=\"hljs-string\">default</span>\n         <span class=\"hljs-attr\">config:</span>\n            <span class=\"hljs-bullet\">-</span>\n             <span class=\"hljs-attr\">subnet:</span> <span class=\"hljs-number\">172.30</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-string\">/16</span>\n</code></pre>\n",
  "link": "/zh-cn/docs/7.分布式/zookeeper/6.集群搭建.html",
  "meta": {}
}